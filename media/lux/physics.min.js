!function(){"use strict";var a=function(a){function b(){return e||(e=a.geom.quadtree(k.nodes())),e}function c(a,b,c){return function(d,e,f,g){if(d.point!==a){var h,i=d.cx-a.x,j=d.cy-a.y,k=g-e,l=i*i+j*j,m=l*Math.sqrt(l);if(l>k*k/b)return h=c*s*d.mass/m,a.vx+=h*i,a.vy+=h*j,!0;d.point&&l&&(h=c*s*d.pointMass/m,a.vx+=h*i,a.vy+=h*j)}return!d.mass}}function d(a,b){var c=0,e=0;if(a.mass=0,!a.leaf)for(var f,g=a.nodes,h=g.length,i=-1;++i<h;)f=g[i],f&&(d(f,b),a.mass+=f.mass,c+=f.mass*f.cx,e+=f.mass*f.cy);if(a.point){a.leaf||(a.point.x+=Math.random()-.5,a.point.y+=Math.random()-.5);var j=r[a.point.index];a.mass+=a.pointMass=j,c+=j*a.point.x,e+=j*a.point.y}a.cx=c/a.mass,a.cy=e/a.mass}var e,f,g,h,i,j,k=a.layout.force().gravity(0).charge(0).friction(0),l=[],m=[],n=[],o=a.dispatch("start","tick","end"),p=1;k.on("start",function(a){var b,c,d=k.nodes(),e=d.length;for(i=.001*(new Date).getTime(),c=0;e>c;++c)b=d[c],isNaN(b.vx)&&(b.vx=0),isNaN(b.vy)&&(b.vy=0);for(c=0;c<m.length;++c)m[c](a);o.start(a)}),k.on("tick",function(a){var b,c,d=k.nodes(),m=d.length;if(e=null,f=k.theta(),g=f*f,j=h?h:0,!j){var n=.001*(new Date).getTime();j=n-i,i=n}for(c=0;c<l.length;++c)l[c](a);for(o.tick(a),c=0;m>c;++c)b=d[c],b.x+=j*b.vx,b.y+=j*b.vy}),k.on("end",function(a){for(var b=0;b<n.length;++b)n[b](a);o.end(a)}),k.dtime=function(a){return arguments.length?(h=+a>0?+a:0,k):h},k.dim=function(a){return arguments.length?(p=+a>0?+a:1,k):p};var q,r,s=parseFloat("6.674e-11"),t=parseFloat("1e-9");k.EARTHMASS=parseFloat("5.97219e24"),k.EARTHRADIUS=6371e3,k.mass=function(a){return arguments.length?(q="function"==typeof a?a:+a,k):q},m.push(function(){var a,b,c=k.nodes(),d=c.length;if(r=[],"function"==typeof q)for(b=0;d>b;++b)a=+q.call(k,c[b],b),r[b]=a>0?a:t;else for(a=+q>0?+q:t,b=0;d>b;++b)r[b]=a}),l.push(function(a){var f,h,i=k.nodes(),l=i.length;if(q&&j)for(e=b(),d(e,a.alpha),h=-1;++h<l;)(f=i[h]).fixed||e.visit(c(f,g,j))});var u;return k.velocityField=function(a){return arguments.length?(u=a,k):u},l.push(function(){if(u){var a,b=k.nodes(),c=b.length;if("function"==typeof u){var d;for(a=0;c>a;++a)d=u.call(k,b[a]),b[a].px+=d[0]*j,b[a].py+=d[1]*j}else for(a=0;c>a;++a)b[a].px+=u[0]*j,b[a].px+=u[1]*j}}),a.rebind(k,o,"on")};"function"==typeof define&&define.amd?define(function(){return a}):"object"==typeof module&&module.exports?module.exports=a:window.d3physics=a}();